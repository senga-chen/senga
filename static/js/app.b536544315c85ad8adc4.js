webpackJsonp([0],{"+1I/":function(e,t){},"+5Gj":function(e,t){},"0XLI":function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("7+uW"),o={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"app-main",attrs:{id:"main"}},[t("router-view")],1)},staticRenderFns:[]};var r=n("VU/8")({data:function(){return{}},mounted:function(){this.$router.push({name:"login"})},beforeDestroy:function(){},methods:{}},o,!1,function(e){n("+1I/")},null,null).exports,a=n("/ocq"),i={name:"user_cover",props:{cover_path:String}},c={render:function(){var e=this.$createElement;return(this._self._c||e)("img",{staticClass:"coverClass",attrs:{src:this.cover_path}})},staticRenderFns:[]};var u=n("VU/8")(i,c,!1,function(e){n("+5Gj")},"data-v-5287b85d",null).exports,l=n("lbHh"),m=n.n(l),d={state:{},mutations:{logout:function(e,t){m.a.remove("user"),m.a.remove("password"),m.a.remove("token"),m.a.remove("cover")}}},v={name:"chatRoom",components:{user_cover:u},data:function(){return{userinfo:{name:"",cover:"",user_id:0,token:""},socket:null}},methods:{init:function(){var e=m.a.get("user"),t=m.a.get("cover"),n=m.a.get("user_id"),s=m.a.get("token");this.userinfo.cover=t,this.userinfo.name=e,this.userinfo.user_id=n,this.userinfo.token=s},socketConnect:function(){this.socket=new WebSocket("ws://127.0.0.1:8088/chatsocket"),this.socket.onmessage=function(e){console.log(e),this.socket.showMessage(JSON.parse(e.data))}},showMessage:function(e){console.log(e)}},beforeCreate:function(){var e=m.a.get("token");e&&"undefined"!==e||(d.$store.commit("logout",this),this.$router.push({name:"login"}))},mounted:function(){this.init(),this.socketConnect()}},f={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"chat_box"}},[n("div",{staticClass:"chat_top"},[n("div",{staticClass:"top_left"},[n("div",{staticClass:"cover"},[n("user_cover",{attrs:{cover_path:e.userinfo.cover}})],1),e._v(" "),n("div",{staticClass:"name"},[e._v("\n          "+e._s(e.userinfo.name)+"\n      ")])]),e._v(" "),n("div",{staticClass:"top_right"},[e._v("\n      欢迎来到聊天室\n    ")])]),e._v(" "),n("div",{staticClass:"chat_content"}),e._v(" "),n("div",{staticClass:"chat_footer"})])},staticRenderFns:[]};var p=n("VU/8")(v,f,!1,function(e){n("tras"),n("V1M6")},"data-v-b075e5b0",null).exports;function h(e,t){var n={method:"POST",headers:{Accept:"application/json, text/plain, */*"},credentials:"include"};return n.body=function(e){var t=new FormData;for(var n in e)t.append(n,e[n]);return t}(t),fetch(e,n).then(function(e){return e.json()})}var _={name:"login",data:function(){return{form:{username:"",password:""},rules:{password:[{required:!0,type:"string",message:"用户名不能为空",trigger:"blur"}],username:[{required:!0,type:"string",message:"密码不能为空",trigger:"blur"}]}}},methods:{handleSubmit:function(){var e,t=this,n=this.form.password,s=this.form.username;(e={username:s,password:n},h("api/user/login",e)).then(function(e){if(0!=e.error_code)alert(e.error_msg);else{var n=e.user.name,s=e.user.token,o=e.user.cover,r=e.user.id;o||(o="http://s1.wmlives.com/data/dongci/user_cover/20180503155855170276.jpg!cover_img_thumbnail");var a={expires:1};console.log(a),m.a.set("user_id",r,a),m.a.set("user",n,a),m.a.set("token",s,a),m.a.set("cover",o,a),t.$router.push({name:"chatRoom"})}}).catch(function(e){console.log(e)})}},mounted:function(){}},g={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{width:"100%",height:"100%",display:"flex","align-items":"center"},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSubmit(t)}}},[n("div",{staticClass:"long_left"}),e._v(" "),n("div",{staticClass:"login_right"},[n("div",{staticClass:"login_content"},[e._m(0),e._v(" "),n("div",{staticClass:"login_input"},[n("form",{ref:"loginForm",attrs:{model:e.form,rules:e.rules}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.form.username,expression:"form.username"}],attrs:{placeholder:"请输入用户名"},domProps:{value:e.form.username},on:{input:function(t){t.target.composing||e.$set(e.form,"username",t.target.value)}}}),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.form.password,expression:"form.password"}],attrs:{placeholder:"请输入密码"},domProps:{value:e.form.password},on:{input:function(t){t.target.composing||e.$set(e.form,"password",t.target.value)}}})])]),e._v(" "),n("Button",{staticClass:"login_btn",on:{click:e.handleSubmit}},[e._v("登录")])],1)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"login_title_box"},[t("div",{staticClass:"login_title"},[this._v("\n          LOGIN\n          "),t("span",[this._v("欢迎登录")])])])}]};var k=n("VU/8")(_,g,!1,function(e){n("0XLI"),n("bYkE")},null,null).exports;s.a.use(a.a);var w=new a.a({mode:"hash",routes:[{path:"/login",name:"login",component:k},{path:"/chatRoom",name:"chatRoom",component:p}]}),C=n("NYxO"),b={state:{cachePage:[],messageCount:0},mutations:{}};s.a.use(C.a);var x=new C.a.Store({state:{},mutations:{},actions:{},modules:{app:b,user:d}});s.a.config.productionTip=!1,new s.a({el:"#app",router:w,components:{App:r},template:"<App/>",store:x})},V1M6:function(e,t){},bYkE:function(e,t){},tras:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.b536544315c85ad8adc4.js.map